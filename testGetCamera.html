<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>testGetCamera</title>
</head>
<body>
<video id="video" width="640" height="480" autoplay></video>  
<button id="snap">Snap Photo</button>  
<canvas id="canvas" width="640" height="480"></canvas>
<img id='img' src=''>
<script>
window.addEventListener('DOMContentLoaded',function(){
	var video=document.getElementById('video'),
		aCanvas=document.getElementById('canvas'),
		ctx=aCanvas.getContext('2d'),
		snap=document.getElementById('snap'),
		img=document.getElementById('img');
	navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;
	navigator.getUserMedia({video:true},goStream,noStream);
	function goStream(stream){
		video.src=URL.createObjectURL(stream);
		video.onerror = function () {  
          stream.stop();  
        };  
        stream.onended = noStream;  
        video.onloadedmetadata = function () {  
          alert('摄像头成功打开！');  
        };
	}
	function noStream(err){
		alert(err);
	}
});
snap.addEventListener('click',function(){
	//绘制canvas图形
    ctx.getContext('2d').drawImage(video, 0, 0, 600, 400);
    //把canvas图像转为img图片
    img.src = canvas.toDataURL("image/png");
},false);
console.log(window.URL);
</script>
</body>
</html>